<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đăng ký tài khoản</title>
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <script src="../js/jquery-3.7.1.min.js"></script>
    <script src="../js/bootstrap.bundle.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            height: 100vh;
        }

        .left {
            flex: 1;
            padding: 50px;
            color: #fff;
        }

        .right {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 350px;
        }

        h1 {
            color: #fff;
            margin-bottom: 20px;
        }

        h2 {
            color: #ee4d2d;
            /* Màu cam đậm */
        }

        input[type="text"],
        input[type="email"],
        input[type="password"] {
            width: 100%;
            padding: 12px 20px;
            margin: 8px 0;
            display: inline-block;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        .error {
            color: #ee4d2d;
            font-size: 14px;
        }

        button[type="submit"] {
            width: 100%;
            padding: 12px 20px;
            background-color: #ee4d2d;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }

        button[type="submit"]:hover {
            background-color: #ff6c51;
        }

        .title {
            width: 100px;
            display: inline-block;
            color: #333;
            font-weight: bold;
            margin-bottom: 10px;
        }

        a {
            text-decoration: none;
        }
    </style>
</head>

<body>
    <section class="bg-danger">
        <div class="container">
            <div class="left text-center">
                <a href="../index.html">
                    <img src="../img/logo3.webp" class="img-fluid" alt="">
                </a>
                <h1>Thiên đường mua sắm dụng cụ nhà bếp</h1>
            </div>
            <div class="right">
                <h2 class="text-center">Đăng Ký Tài Khoản</h2>
                <br>
                <form id="registration-form">
                    <div class="form-group">
                        <input type="text" class="form-control" id="txtDN" name="txtDN" placeholder="Tên đăng nhập">
                        <span class="error" id="tendn"></span>
                    </div>
                    <div class="form-group">
                        <input type="email" class="form-control" id="email" name="email" placeholder="Email">
                        <span class="error" id="email-error"></span>
                    </div>
                    <div class="form-group">
                        <input type="password" class="form-control" id="txtMK" name="txtMK" placeholder="Mật khẩu">
                        <span class="error" id="mk"></span>
                    </div>
                    <div class="form-group">
                        <input type="password" class="form-control" id="txtXNMK" name="txtXNMK"
                            placeholder="Nhập lại mật khẩu">
                        <span class="error" id="xnmk"></span>
                    </div>
                    <br>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary">Đăng ký</button>
                    </div>
                </form>
                <br>
                <div class="footer text-center">
                    <p>Đã có tài khoản? <a href="../index.html">Đăng nhập</a></p>
                </div>
            </div>
        </div>
    </section>

    <script>
        $(document).ready(function () {
            // Function to validate username
            function validateUsername(username) {
                var usernameRegex = /^[A-Za-z][A-Za-z0-9_]*$/;
                return usernameRegex.test(username);
            }

            // Function to validate email
            function validateEmail(email) {
                var emailRegex = /^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/;
                return emailRegex.test(email);
            }

            // Event listeners for blur
            $('#txtDN').blur(function () {
                var username = $(this).val();
                var errorSpan = $('#tendn');
                if (!validateUsername(username)) {
                    errorSpan.text('Tên đăng nhập không hợp lệ');
                } else {
                    errorSpan.text('');
                }
            });

            $('#email').blur(function () {
                var email = $(this).val();
                var errorSpan = $('#email-error');
                if (!validateEmail(email)) {
                    errorSpan.text('Email không hợp lệ');
                } else {
                    errorSpan.text('');
                }
            });

            $('#txtMK').blur(function () {
                var password = $(this).val();
                var errorSpan = $('#mk');
                if (password.length < 6 || !/\d/.test(password)) {
                    errorSpan.text('Mật khẩu phải có ít nhất 6 kí tự và chứa ít nhất một chữ số');
                } else {
                    errorSpan.text('');
                }
            });

            $('#txtXNMK').blur(function () {
                var confirmPassword = $(this).val();
                var password = $('#txtMK').val();
                var errorSpan = $('#xnmk');
                if (confirmPassword !== password) {
                    errorSpan.text('Xác nhận mật khẩu không khớp');
                } else {
                    errorSpan.text('');
                }
            });

            // Xử lý sự kiện khi form đăng ký được submit
            $('#registration-form').submit(function (e) {
                e.preventDefault(); // Ngăn chặn form gửi đi mặc định

                // Lấy giá trị người dùng nhập vào
                var username = $('#txtDN').val();
                var email = $('#email').val();
                var password = $('#txtMK').val();
                var confirmPassword = $('#txtXNMK').val();

                // Validation
                if (!validateUsername(username)) {
                    $('#tendn').text('Tên đăng nhập không hợp lệ');
                    return;
                }

                if (!validateEmail(email)) {
                    $('#email-error').text('Email không hợp lệ');
                    return;
                }

                if (password.length < 6 || !/\d/.test(password)) {
                    $('#mk').text('Mật khẩu phải có ít nhất 6 kí tự và chứa ít nhất một chữ số');
                    return;
                }

                if (confirmPassword !== password) {
                    $('#xnmk').text('Xác nhận mật khẩu không khớp');
                    return;
                }

                // Lấy dữ liệu từ Local Storage
                var storedUserData = JSON.parse(localStorage.getItem('userAccounts'));

                // Tạo một đối tượng mới đại diện cho tài khoản đăng ký
                var newUser = {
                    'username': username,
                    'email': email,
                    'password': password
                };

                // Kiểm tra nếu storedUserData không tồn tại, tạo một mảng mới
                if (!storedUserData) {
                    storedUserData = [];
                }

                // Thêm tài khoản mới vào mảng
                storedUserData.push(newUser);

                // Lưu mảng các tài khoản vào Local Storage
                localStorage.setItem('userAccounts', JSON.stringify(storedUserData));

                alert('Đăng ký thành công!');
                // Redirect hoặc thực hiện hành động khác sau khi đăng ký thành công
            });
        });

    </script>
</body>

</html>